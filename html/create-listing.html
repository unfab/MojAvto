<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ustvari oglas - MojAvto.si</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <div id="header"></div>

  <main>
    <h2>Ustvari oglas</h2>
    <form id="listingForm">
      <label for="brand">Znamka vozila:</label>
      <select id="brand" name="brand" required>
        <option value="">Izberi znamko</option>
        <!-- Dinamično generirano -->
      </select>

      <label for="model">Model:</label>
      <select id="model" name="model" required disabled>
        <option value="">Najprej izberi znamko</option>
      </select>

      <label for="fuel">Vrsta goriva:</label>
      <select id="fuel" name="fuel" required>
        <option value="">Izberi</option>
        <option>Bencin</option>
        <option>Dizel</option>
        <option>Hibrid</option>
        <option>Elektrika</option>
        <option>Plin</option>
      </select>

      <label for="mileage">Kilometri:</label>
      <select id="mileage" name="mileage" required>
        <option value="">Izberi razpon</option>
        <option>0 - 10.000 km</option>
        <option>10.001 - 50.000 km</option>
        <option>50.001 - 100.000 km</option>
        <option>100.001 - 200.000 km</option>
        <option>200.001 km+</option>
      </select>

      <label for="year">Letnik:</label>
      <select id="year" name="year" required>
        <option value="">Izberi letnik</option>
        <!-- Dinamično napolni od 1990 do letos -->
      </select>

      <label for="transmission">Menjalnik:</label>
      <select id="transmission" name="transmission" required>
        <option value="">Izberi</option>
        <option>Ročni</option>
        <option>Avtomatski</option>
      </select>

      <label for="drive">Pogon:</label>
      <select id="drive" name="drive" required>
        <option value="">Izberi</option>
        <option>Prednji</option>
        <option>Zadnji</option>
        <option>4x4</option>
      </select>

      <label for="description">Opis vozila:</label>
      <textarea id="description" name="description" rows="5" required></textarea>

      <label for="images">Naloži slike:</label>
      <input type="file" id="images" name="images" accept="image/*" multiple required />

      <button type="submit">Objavi oglas</button>
    </form>
  </main>

  <!-- Load your user menu script -->
  <script src="js/userMenu.js" defer></script>

  <!-- Inject header and initialize -->
  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header").innerHTML = data;
        initUserMenu();
      })
      .catch(err => console.error("Failed to load header:", err));
  </script>

  <script>
    // Znamke in modeli - lahko kasneje naložiš iz zunanjo JSON datoteko
    const brandModelData = {
      "Audi": ["A1", "A3", "A4", "A6", "A8", "Q2", "Q3", "Q5", "Q7", "Q8"],
      "BMW": ["1 Series", "3 Series", "5 Series", "7 Series", "X1", "X3", "X5"],
      "Volkswagen": ["Golf", "Passat", "Tiguan", "Polo", "Touareg", "Arteon"],
      "Škoda": ["Fabia", "Octavia", "Superb", "Kamiq", "Karoq", "Enyaq"],
      "Mercedes-Benz": ["A-Class", "C-Class", "E-Class", "S-Class", "GLA", "GLE", "GLC"],
      "Ford": ["Fiesta", "Focus", "Mondeo", "Kuga", "Puma", "EcoSport"],
      "Renault": ["Clio", "Megane", "Captur", "Kadjar", "Talisman"],
      "Peugeot": ["208", "308", "2008", "3008", "5008"],
      "Toyota": ["Aygo", "Yaris", "Corolla", "C-HR", "RAV4"],
      "Honda": ["Civic", "Jazz", "CR-V", "HR-V"],
      "Hyundai": ["i10", "i20", "i30", "Tucson", "Santa Fe"],
      "Kia": ["Picanto", "Rio", "Ceed", "Sportage", "Sorento"],
      "Fiat": ["500", "Panda", "Tipo", "Punto"],
      "Dacia": ["Sandero", "Logan", "Duster", "Lodgy"],
      "Cupra": ["Ateca", "Leon", "Formentor"],
      "DS Automobiles": ["DS3", "DS4", "DS7"],
      "Alfa Romeo": ["Giulietta", "Giulia", "Stelvio", "Tonale"],
      "Tesla": ["Model 3", "Model S", "Model X", "Model Y"],
      "Porsche": ["Cayenne", "Panamera", "Macan", "Taycan"]
    };

    // Napolni znamke ob nalaganju strani
    document.addEventListener("DOMContentLoaded", () => {
      const brandSelect = document.getElementById("brand");
      const modelSelect = document.getElementById("model");
      const yearSelect = document.getElementById("year");

      // Polnjenje znamk
      Object.keys(brandModelData).sort().forEach(brand => {
        const option = document.createElement("option");
        option.value = brand;
        option.textContent = brand;
        brandSelect.appendChild(option);
      });

      // Polnjenje letnikov od letos do 1990
      const currentYear = new Date().getFullYear();
      for(let y = currentYear; y >= 1990; y--) {
        const opt = document.createElement("option");
        opt.value = y;
        opt.textContent = y;
        yearSelect.appendChild(opt);
      }

      // Ko izbereš znamko, se napolnijo modeli
      brandSelect.addEventListener("change", function() {
        modelSelect.innerHTML = '<option value="">Izberi model</option>';
        modelSelect.disabled = true;

        const selectedBrand = this.value;
        if(selectedBrand && brandModelData[selectedBrand]) {
          brandModelData[selectedBrand].forEach(model => {
            const opt = document.createElement("option");
            opt.value = model;
            opt.textContent = model;
            modelSelect.appendChild(opt);
          });
          modelSelect.disabled = false;
        }
      });
    });
  </script>
</body>
</html>
